# STA2002 概率与统计II - Lecture 8: 假设检验III

## 概述
本讲重点讨论比例的假设检验：
- 单个比例检验
- 两个比例之差检验
- 实际应用案例

## 比例假设检验基础

### 背景
X₁,...,Xn ~ Bernoulli(p)
Y = ΣX_i ~ Binomial(n,p)

### 大样本近似
当n足够大时：
$$\hat{p} = Y/n \approx N\left(p, \frac{p(1-p)}{n}\right)$$

### 检验统计量
$$T = \frac{\hat{p} - p_0}{\sqrt{p_0(1-p_0)/n}} \approx N(0,1)$$

## 单个比例的检验

### 双侧检验 H₀: p = p₀ vs H₁: p ≠ p₀
p值 = 2 P(Z > |z|)
拒绝域: |z| ≥ z_{α/2}

### 右侧检验 H₀: p = p₀ vs H₁: p > p₀
p值 = P(Z > z)
拒绝域: z ≥ z_α

### 左侧检验 H₀: p = p₀ vs H₁: p < p₀
p值 = P(Z < z)
拒绝域: z ≤ -z_α

### 示例：骰子公平性检验
H₀: p = 1/6 vs H₁: p ≠ 1/6
n=8000, 出现6的次数 y=1389
$$\hat{p} = 1389/8000 = 0.173625$$

z = (0.173625 - 1/6) / √[(1/6)(5/6)/8000] = 1.67
z_{0.025} = 1.96
p值 = 2 P(Z > 1.67) = 0.0949 > 0.05
决策：不拒绝H₀

如果用α=0.10，z_{0.05}=1.64，|z|=1.67 > 1.64，则拒绝H₀

## 两个比例之差的检验

### 背景
两个独立样本：
X₁,...,Xn₁ ~ Bernoulli(p₁)
Y₁,...,Yn₂ ~ Bernoulli(p₂)

检验 H₀: p₁ = p₂ vs H₁: p₁ ≠ p₂

### 合并比例
$$\hat{p} = \frac{n_1 \hat{p}_1 + n_2 \hat{p}_2}{n_1 + n_2}$$

### 检验统计量
$$T = \frac{\hat{p}_1 - \hat{p}_2}{\sqrt{\hat{p}(1-\hat{p})(1/n_1 + 1/n_2)}} \approx N(0,1)$$

### 示例：低出生体重率比较
n₁=200, y₁=22 (低出生体重婴儿)
n₂=100, y₂=16

$$\hat{p}_1 = 22/200 = 0.11$$
$$\hat{p}_2 = 16/100 = 0.16$$
$$\hat{p} = (22+16)/(200+100) = 38/300 = 0.1267$$

t = (0.11 - 0.16) / √[0.1267×0.8733×(1/200+1/100)] = -1.23
p值 = 2 P(Z < -1.23) = 0.219 > 0.05
决策：不拒绝H₀

## 难点讲解

### 1. 大样本条件
中心极限定理要求：
- n p₀ (1-p₀) ≥ 5
- 通常 n ≥ 30 且 p₀ 不太接近0或1

### 2. 检验统计量的标准化
比例检验中，我们用假设的p₀来标准化：
$$SE = \sqrt{\frac{p_0(1-p_0)}{n}}$$

但在置信区间中，我们用估计的$$\hat{p}$$：
$$SE = \sqrt{\frac{\hat{p}(1-\hat{p})}{n}}$$

### 3. 两个比例检验的合并估计
为什么要用合并比例$$\hat{p}$$？
- H₀下 p₁ = p₂ = p
- 合并估计更稳定
- 当样本量相近时表现良好

### 4. 比例检验的保守性
比例检验比均值检验更保守，因为：
- 二项分布的方差取决于p
- 当p接近0或1时，近似更差
- 样本量要求更高

### 5. 实际应用中的注意事项
- 比例检验常用于：
  - 选举民调
  - 医疗试验成功率
  - 质量控制合格率
- 结果解读要考虑：
  - 实际意义 vs 统计显著性
  - 置信区间宽度
  - 样本代表性

### 6. 精确检验 vs 近似检验
- **精确检验**: 用二项分布精确计算p值
- **近似检验**: 用正态近似，计算简单但要求大样本
- 实际中：样本量大时近似很好，样本量小时用精确法

## 总结表

| 检验类型 | H₀ | H₁ | 统计量 | p值 | 拒绝域 |
|----------|-----|-----|--------|-----|--------|
| 单比例 | p=p₀ | p>p₀ | z=(ˆp-p₀)/√[p₀(1-p₀)/n] | P(Z>z) | z≥z_α |
| 单比例 | p=p₀ | p<p₀ | 同上 | P(Z<z) | z≤-z_α |
| 单比例 | p=p₀ | p≠p₀ | 同上 | 2P(Z>\|z\|) | \|z\|≥z_{α/2} |
| 双比例 | p₁=p₂ | p₁>p₂ | t=(ˆp₁-ˆp₂)/√[ˆp(1-ˆp)(1/n₁+1/n₂)] | P(Z>t) | t≥z_α |
| 双比例 | p₁=p₂ | p₁<p₂ | 同上 | P(Z<t) | t≤-z_α |
| 双比例 | p₁=p₂ | p₁≠p₂ | 同上 | 2P(Z>\|t\|) | \|t\|≥z_{α/2} |

## 练习题
1. 计算一个比例的检验统计量
2. 解释为什么比例检验需要大样本
3. 设计两个比例比较的假设检验
4. 比较精确检验和近似检验
5. 计算民调数据的置信区间和检验
