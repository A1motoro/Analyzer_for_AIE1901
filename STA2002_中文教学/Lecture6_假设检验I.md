# STA2002 概率与统计II - Lecture 6: 假设检验I

## 概述
本讲介绍假设检验的基本概念和方法：
- 重要概念：原假设、备择假设
- 检验统计量和临界区域
- 类型I/II错误
- 显著性水平
- p值
- 均值假设检验

## 动机示例：钢条强度检验

### 背景
现有两种生产工艺：
- 工艺I：钢条强度 ~ N(50, 36)
- 工艺II（新工艺）：希望强度 ~ N(55, 36)

### 问题
基于新工艺生产的钢条样本，如何检验强度是否提高了5个单位？

## 假设设定

### 原假设 H₀ (Null Hypothesis)
初始信念/主张/假设，即参数取值范围

### 备择假设 H₁ (Alternative Hypothesis)
与原假设竞争的假设

### 简单vs复合假设
- **简单假设**: 参数只取一个值 (H₀: μ=50)
- **复合假设**: 参数取值范围 (H₀: μ≤50)

### 常见假设形式
- H₀: μ = μ₀ vs H₁: μ = μ₁ (简单vs简单)
- H₀: μ = μ₀ vs H₁: μ > μ₀ (单侧)
- H₀: μ = μ₀ vs H₁: μ < μ₀ (单侧)
- H₀: μ = μ₀ vs H₁: μ ≠ μ₀ (双侧)
- H₀: μ ≤ μ₀ vs H₁: μ > μ₀ (复合vs复合)

## 检验统计量和临界区域

### 样本空间
D = {(x₁,x₂,...,xₙ) | xᵢ ∈ S_X}

### 临界区域 C (Critical Region)
拒绝H₀的样本区域

### 检验统计量 T
通常基于T的函数形式定义C

### 示例
T = $$\bar{X}$$ ~ N(μ, 36/n)
临界区域：C = {x | $$\bar{x}$$ ≥ 53}
决策规则：$$\bar{x}$$ ≥ 53 则拒绝H₀

## 假设检验的错误

### 类型I错误 (Type I Error)
拒真H₀：α = P(拒绝H₀ | H₀真)

### 类型II错误 (Type II Error)
纳伪H₀：β = P(不拒绝H₀ | H₀伪)

### 错误概率关系
- α和β通常不可同时最小化
- α↓ ⇒ β↑ (反之亦然)

### 示例计算
n=16, C={$$\bar{x}$$≥53}
H₀: μ=50, H₁: μ=55

α = P($$\bar{X}$$≥53 | μ=50) = P(Z ≥ (53-50)/√(36/16)) = P(Z≥1.33) = 0.0918
β = P($$\bar{X}$$<53 | μ=55) = P(Z < (53-55)/√(36/16)) = P(Z<-0.67) = 0.2514

## 显著性水平 (Significance Level)

### 定义
α = P(Type I Error) = 检验的显著性水平

### 常见值
α = 0.05 (5%), α = 0.01 (1%)

### 决策规则
- p值 ≤ α ⇒ 拒绝H₀
- p值 > α ⇒ 不拒绝H₀

## p值 (p-value)

### 定义
观察到更极端检验统计量的概率（H₀下）

### 直观理解
p值越小，数据越不支持H₀

### 示例
H₀: μ=50 vs H₁: μ=55，观察 $$\bar{x}$$=56
"更极端" = {$$\bar{X}$$ ≥ 56}
p值 = P($$\bar{X}$$ ≥ 56 | μ=50)

H₀: μ=55 vs H₁: μ > 55，"更极端" = {$$\bar{X}$$ ≥ 56}
H₀: μ=55 vs H₁: μ < 55，"更极端" = {$$\bar{X}$$ ≤ 56}
H₀: μ=55 vs H₁: μ ≠ 55，"更极端" = {$$\bar{X}$$ ≥ 56 or $$\bar{X}$$ ≤ 54}

## 三种等价方法

### 1. p值方法
计算p值，与α比较

### 2. 临界区域方法
定义拒绝域，检查统计量是否落入

### 3. 置信区间方法
构造CI，检查H₀参数值是否在CI内

**三者等价！**

## 正态均值检验

### Case 1: 方差已知

#### 检验统计量
$$T = \frac{\bar{X} - \mu_0}{\sigma/\sqrt{n}} \sim N(0,1)$$

#### 双侧检验 H₀: μ=μ₀ vs H₁: μ≠μ₀
p值 = 2 P(Z > |z|)
拒绝域: |z| ≥ z_{α/2}
CI等价: μ₀ ∉ [$$\bar{x}$$ - z_{α/2} σ/√n, $$\bar{x}$$ + z_{α/2} σ/√n]

#### 右侧检验 H₀: μ=μ₀ vs H₁: μ>μ₀
p值 = P(Z > z)
拒绝域: z ≥ z_α
CI等价: μ₀ ∉ ($$\bar{x}$$ - z_α σ/√n, ∞)

#### 左侧检验 H₀: μ=μ₀ vs H₁: μ<μ₀
p值 = P(Z < z)
拒绝域: z ≤ -z_α
CI等价: μ₀ ∉ (-∞, $$\bar{x}$$ + z_α σ/√n)

### Case 2: 方差未知

#### 检验统计量
$$T = \frac{\bar{X} - \mu_0}{S/\sqrt{n}} \sim t(n-1)$$

#### 其余完全类似，只是用t分布代替正态分布

## 难点讲解

### 1. H₀ 和 H₁ 的设定
- H₀ 通常是"无变化""无差异"的假设
- H₁ 是我们想要证明的假设
- 单侧vs双侧取决于研究问题

### 2. 类型I vs 类型II错误
- **类型I**: 假阳性 - 声称有效应但实际没有
- **类型II**: 假阴性 - 遗漏了真实效应
- 在司法中：类型I如冤案，类型II如漏犯

### 3. p值的误解
p值 ≠ 效应大小
p值 ≠ 结果的重要性
p值只是衡量数据与H₀不一致的程度

### 4. 检验效能 (Power)
效能 = 1 - β，在备择假设下拒绝H₀的概率
效能取决于：样本量、效应大小、α水平、方差

### 5. 假设检验 vs 置信区间
- 假设检验：参数是否等于特定值？
- 置信区间：参数的可能取值范围
- 两者互补，但不能完全替代

### 6. 实际应用中的注意事项
- 多重检验问题 (p值膨胀)
- 数据挖掘偏差
- 前期vs事后检验

## 总结表

| H₀ | H₁ | p值 | 拒绝域 | CI条件 |
|-----|-----|-----|--------|--------|
| μ=μ₀ | μ>μ₀ | P(Z>z) | z≥z_α | μ₀ ∉ (L,∞) |
| μ=μ₀ | μ<μ₀ | P(Z<z) | z≤-z_α | μ₀ ∉ (-∞,U) |
| μ=μ₀ | μ≠μ₀ | 2P(Z>\|z\|) | \|z\|≥z_{α/2} | μ₀ ∉ (L,U) |

## 练习题
1. 解释类型I和类型II错误的区别
2. 计算一个具体假设检验的p值
3. 说明p值与显著性水平的区别
4. 设计一个双侧均值检验
5. 比较假设检验与置信区间
